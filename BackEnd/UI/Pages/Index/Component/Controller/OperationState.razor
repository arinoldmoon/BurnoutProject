@inherits OperationStateComponent

<RadzenCard style="height: 330px;">
    <ChildContent>
        <div class="row">
            <div class="col-md-8">
                <RadzenLabel
                    Text="@($"PatternNumber : {SelectedPattern.PatternNumber} | {Globals.GlobalMonitor.Status.PatternStatus}")">
                </RadzenLabel>

            </div>
            @if (!Globals.GlobalMonitor.Status.Operation)
            {
                <div class="col-md-4">
                    <RadzenButton ButtonStyle="ButtonStyle.Warning" ButtonType="ButtonType.Button" Disabled="false"
                    IsBusy="false" Size="ButtonSize.Small" style="width: 100%" Text="Edit"
                    Click="@(args => EditProgramClick(args))">
                    </RadzenButton>
                </div>
            }
        </div>
        <div class="row align-items-center" style="padding-top: 15px;">
            <div class="col-md-12">
                <RadzenTabs style="height: 200px;">
                    <Tabs>
                        <RadzenTabsItem Text="Step">
                            <RadzenDataGrid @ref="OvenStepGrid" AllowVirtualization="true"
                                AllowRowSelectOnRowClick="false" AllowFiltering="false" AllowPaging="false"
                                AllowSorting="false" Data="@(SelectedPattern.PatternItems)" TItem="PatternItem"
                                SelectionMode="DataGridSelectionMode.Single" @bind-Value=@CurrentPattern>
                                <Columns>
                                    <RadzenDataGridColumn TItem="PatternItem" Property="Step" Title="Step"
                                        TextAlign="TextAlign.Center" Width="80px">
                                    </RadzenDataGridColumn>
                                    <RadzenDataGridColumn TItem="PatternItem" Property="Temp" Title="Temp"
                                        TextAlign="TextAlign.Center" Width="80px">
                                    </RadzenDataGridColumn>
                                    <RadzenDataGridColumn TItem="PatternItem" Title="Duration"
                                        TextAlign="TextAlign.Center">
                                        <Template Context="data">
                                            @TimeSpan.FromMinutes(data.StepDuration).ToString(@"hh\:mm") Hrs.
                                        </Template>
                                    </RadzenDataGridColumn>
                                </Columns>
                            </RadzenDataGrid>
                        </RadzenTabsItem>
                        <RadzenTabsItem Text="Heating">
                            <RadzenHeading Text="Tube Heater" Size="H4" style="margin-bottom: -5px;"></RadzenHeading>
                            <RadzenLabel Text="On when temperature reach"></RadzenLabel>
                            <RadzenLabel Text=@($"{Setting.TubeStartTemp} °C") style="font-weight: bold;"></RadzenLabel>
                            <hr>
                            <RadzenHeading Text="Floor Heater" Size="H4" style="margin-bottom: -5px;"></RadzenHeading>
                            <RadzenLabel Text="On when temperature reach"></RadzenLabel>
                            <RadzenLabel Text=@($"{Setting.FloorStartTemp} °C") style="font-weight: bold;">
                            </RadzenLabel>
                            <hr>
                            <RadzenHeading Text="After Burner" Size="H4" style="margin-bottom: -5px;"></RadzenHeading>
                            <RadzenLabel Text="On when temperature reach"></RadzenLabel>
                            <RadzenLabel Text=@($"{Setting.AfbStartTemp} °C") style="font-weight: bold;"></RadzenLabel>
                            <br />
                            <RadzenLabel Text="Off when temperature reach"></RadzenLabel>
                            <RadzenLabel Text=@($"{Setting.AfbEndTemp} °C") style="font-weight: bold;"></RadzenLabel>
                            <br />
                            <RadzenLabel Text="Turn off delay"></RadzenLabel>
                            <RadzenLabel Text=@($"{Setting.AfbDelay} Min") style="font-weight: bold;"></RadzenLabel>
                            <hr>
                            <RadzenHeading Text="Overheat Alarm" Size="H4" style="margin-bottom: -5px;"></RadzenHeading>
                            <RadzenLabel Text="Oven temperature limit at"></RadzenLabel>
                            <RadzenLabel Text=@($"{Setting.AlarmOven} °C") style="font-weight: bold;"></RadzenLabel>
                            <br />
                            <RadzenLabel Text="After burner temperature limit at "></RadzenLabel>
                            <RadzenLabel Text=@($"{Setting.AlarmAfb} °C") style="font-weight: bold;"></RadzenLabel>
                        </RadzenTabsItem>
                        <RadzenTabsItem Text="Setting">
                            <RadzenHeading Text="Air Flow Settings" Size="H4" style="margin-bottom: -5px;">
                            </RadzenHeading>
                            <RadzenLabel Text="On when temperature reach"></RadzenLabel>
                            <RadzenLabel Text=@($"{Globals.GlobalPattern.Airpump.StartTemp} °C")
                                style="font-weight: bold;">
                            </RadzenLabel><br />
                            <RadzenLabel Text="Off when temperature reach"></RadzenLabel>
                            <RadzenLabel Text=@($"{Globals.GlobalPattern.Airpump.EndTemp} °C")
                                style="font-weight: bold;">
                            </RadzenLabel><br />
                            <RadzenLabel Text="Turn off delay"></RadzenLabel>
                            <RadzenLabel Text=@($"{Globals.GlobalPattern.Airpump.DelayDuration} Min")
                                style="font-weight: bold;"></RadzenLabel>
                            <hr>
                        </RadzenTabsItem>
                    </Tabs>
                </RadzenTabs>
            </div>
        </div>
        @if (!Globals.GlobalMonitor.Status.Operation)
        {
            <div class="row" style="padding-top: 15px;">
                <div class="col-md-9 d-flex justify-content-around">
                    <RadzenButton ButtonStyle="ButtonStyle.Success" ButtonType="ButtonType.Button" Size="ButtonSize.Medium"
                    Text="Start Operation" style="width: 100%" Click="@(args => StartOperation(args))">
                    </RadzenButton>
                </div>
                <div class="col-md-3 d-flex justify-content-around">
                    <RadzenButton ButtonStyle="ButtonStyle.Danger" ButtonType="ButtonType.Button" Icon="close"
                    Size="ButtonSize.Medium" style="width: 100%" Click="@(args => CancelProgram(args))">
                    </RadzenButton>
                </div>
            </div>
        }
        else
        {
            <div class="row" style="padding-top: 15px;">
                <div class="col-md-12  d-flex justify-content-around">
                    <RadzenButton ButtonStyle="ButtonStyle.Danger" ButtonType="ButtonType.Button" Size="ButtonSize.Small"
                    style="width: 100%" Text="Stop Operation" Click="@(args => StopOperation(args))">
                    </RadzenButton>
                </div>
            </div>
        }
    </ChildContent>
</RadzenCard>